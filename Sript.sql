CREATE DATABASE EXAM;

USE EXAM;

CREATE TABLE USER(
    IDUSER INTEGER PRIMARY KEY AUTO_INCREMENT,
    NOM VARCHAR(50) NOT NULL,
    MAIL VARCHAR(100) NOT NULL,
    MDP VARCHAR(50) NOT NULL,
    ISADMIN INTEGER NOT NULL
);

CREATE TABLE INFOUTILISATEUR(
    IDUSER INTEGER NOT NULL,
    GENRE INTEGER NOT NULL,
    AGE INTEGER NOT NULL,
    TAILLE DOUBLE NOT NULL,
    POIDS DOUBLE NOT NULL,
    FOREIGN KEY (IDUSER) REFERENCES USER(IDUSER)
);

CREATE TABLE COMPTEUSER(
    IDCOMPTE INTEGER PRIMARY KEY AUTO_INCREMENT,
    IDUSER INTEGER NOT NULL,
    SOLDE DOUBLE NOT NULL,
    FOREIGN KEY (IDUSER) REFERENCES USER(IDUSER)
);

CREATE TABLE CODE (
    IDCODE INTEGER PRIMARY KEY AUTO_INCREMENT,
    CODE VARCHAR(5) NOT NULL,
    MONTANT DOUBLE NOT NULL,
    ETAT INT NOT NULL
);

CREATE TABLE VALIDATIONCODE(
    IDUSER INTEGER NOT NULL,
    IDCODE INTEGER NOT NULL,
    DATEARRIVER DATE NOT NULL,
    DATEVALIDATION DATE NOT NULL,
    FOREIGN KEY (IDCODE) REFERENCES USER(IDCODE)
);

CREATE TABLE REGIME(
    IDREGIME INTEGER PRIMARY KEY AUTO_INCREMENT,
    NOM VARCHAR(100) NOT NULL,
    DUREE INTEGER NOT NULL,
    POIDS DOUBLE NOT NULL,
    PRIX DOUBLE NOT NULL
);

CREATE TABLE ACTIVITESPORTIF(
    IDACTIVITE INTEGER PRIMARY KEY AUTO_INCREMENT,
    IDREGIME INTEGER NOT NULL,
    NOM VARCHAR(50) NOT NULL,
    FOREIGN KEY (IDREGIME) REFERENCES USER(IDREGIME)
);

CREATE TABLE REGIMEUSER(
    IDUSER INTEGER NOT NULL,
    IDREGIME INTEGER NOT NULL,
    DUREE INTEGER NOT NULL,
    PRIX DOUBLE NOT NULL,
    FOREIGN KEY (IDUSER) REFERENCES USER(IDUSER),
    FOREIGN KEY (IDREGIME) REFERENCES USER(IDREGIME)
);

CREATE TABLE OBJECTIF(
    IDOBJECTIF INTEGER PRIMARY KEY AUTO_INCREMENT,
    NOM VARCHAR(50) NOT NULL
);

CREATE TABLE OBJECTFUSER(
    IDOBJECTIF INTEGER NOT NULL,
    IDUSER INTEGER NOT NULL,
    POIDSCIBLE DOUBLE NOT NULL,
    FOREIGN KEY (IDOBJECTIF) REFERENCES USER(IDOBJECTIF)
);

INSERT INTO `USER` (
    `IDUSER`,
    `NOM`,
    `MAIL`,
    `MDP`,
    `ISADMIN`
) VALUES
 -- (1, 'admin', 'admin@gmail.com', 'admin', 1),
(
    NULL,
    'mano',
    'mano@gmail.com',
    'admin',
    0
),
(
    NULL,
    'jimmy',
    'jimmy@gmail.com',
    'admin',
    0
),
(
    NULL,
    'antonio',
    'antonio@gmail.com',
    'admin',
    0
);

INSERT INTO INFOUTILISATEUR (
    IDUSER,
    GENRE,
    AGE,
    TAILLE,
    POIDS
) VALUES (
    2,
    1,
    13,
    1.50,
    20
);

INSERT INTO `USER` (
    `NOM`,
    `MAIL`,
    `MDP`,
    `ISADMIN`
) VALUES (
    'admin',
    'admin@gmail.com',
    'admin',
    1
),
(
    'mano',
    'mano@gmail.com',
    'admin',
    0
),
(
    'jimmy',
    'jimmy@gmail.com',
    'admin',
    0
),
(
    'antonio',
    'antonio@gmail.com',
    'admin',
    0
);

DELETE FROM OBJECTFUSER;

DELETE FROM REGIMEUSER;

DELETE FROM ACTIVITESPORTIF;

DELETE FROM OBJECTIF;

DELETE FROM VALIDATIONCODE;

DELETE FROM CODE;

DELETE FROM COMPTEUSER;

DELETE FROM INFOUTILISATEUR;

DELETE FROM REGIME;

DELETE FROM USER;

DROP TABLE OBJECTFUSER;

DROP TABLE REGIMEUSER;

DROP TABLE ACTIVITESPORTIF;

DROP TABLE OBJECTIF;

DROP TABLE VALIDATIONCODE;

DROP TABLE CODE;

DROP TABLE COMPTEUSER;

DROP TABLE INFOUTILISATEUR;

DROP TABLE REGIME;

DROP TABLE USER;

INSERT INTO INFOUTILISATEUR(
    IDUSEUR,
    GENRE,
    AGE,
    TAILLE,
    POIDS
) VALUES(
    4,
    2,
    20,
    1.66,
    55
),
(
    5,
    1,
    43,
    1.50,
    45
),
(
    3,
    1,
    43,
    1.70,
    60
);

-- INSERT INTO compteUser(idCompte,idUser,solde) VALUES()
INSERT INTO CODE (
    IDCODE,
    CODE,
    MONTANT,
    ETAT
) VALUES(
    NULL,
    6876414,
    50000,
    0
),
(
    NULL,
    763654,
    150000,
    0
),
(
    NULL,
    7685234,
    70000,
    0
),
(
    NULL,
    89576245,
    150000,
    0
),
(
    NULL,
    8975284,
    500000,
    0
),
(
    NULL,
    68791534,
    600000,
    0
),
(
    NULL,
    7865112,
    120000,
    0
),
(
    NULL,
    527845,
    30000,
    0
),
(
    NULL,
    687513,
    50000,
    0
),
(
    NULL,
    61284,
    100000,
    0
),
(
    NULL,
    57688126,
    90000,
    0
),
(
    NULL,
    76789265,
    60000,
    0
);

-- INSERT INTO validationCode(idUser,code,dateArriver,dateValidation)VALUES()
INSERT INTO OBJECTIF(
    IDOBJECTIF,
    NOM
) VALUES(
    NULL,
    'Amaigrissement'
),
(
    NULL,
    'Mapatavy'
);

INSERT INTO REGIME(
    IDREGIME,
    IDOBJECTIF,
    NOM,
    DUREE,
    POIDS,
    PRIX
) VALUES(
    NULL,
    1,
    'R1',
    60,
    8,
    1500000
),
(
    NULL,
    2,
    'R2',
    20,
    2.5,
    300000
),
(
    NULL,
    2,
    'R3',
    30,
    4,
    500000
),
(
    NULL,
    1,
    'R4',
    80,
    10,
    10000
),
(
    NULL,
    1,
    'R5',
    40,
    5,
    10000
);

INSERT INTO ACTIVITESPORTIF(
    IDACTIVITE,
    IDREGIME,
    NOM
) VALUES(
    NULL,
    1,
    'Squat'
),
(
    NULL,
    2,
    'Pomp'
),
(
    NULL,
    3,
    'Flexion'
),
(
    NULL,
    4,
    'Cardio'
),
(
    NULL,
    5,
    'Marcher'
);

INSERT INTO REGIMEUSER(
    IDUSER,
    IDREGIME,
    DUREE,
    PRIX
)VALUES(
);

INSERT INTO OBJECTFUSER(
    IDOBJECTIF,
    IDUSER,
    POIDSCIBLE
) VALUES(
);